# Astro Server - Aggressive Fail2Ban Configuration
# High security profile with strict banning policies

[DEFAULT]
# Ban Settings
bantime = 86400          # 24 hours
findtime = 300           # 5 minutes
maxretry = 2             # 2 attempts before ban
backend = systemd        # Use systemd journal

# Email notifications (configure as needed)
# destemail = admin@example.com
# sender = fail2ban@example.com
# mta = sendmail

# Ban Action
banaction = iptables-multiport
banaction_allports = iptables-allports

[sshd]
enabled = true
mode = aggressive
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
bantime = 86400          # 24 hours for SSH
findtime = 300           # 5 minutes
maxretry = 2             # 2 failed attempts

[sshd-ddos]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
bantime = 86400
findtime = 120           # 2 minutes
maxretry = 6             # 6 connections in 2 minutes

# Web server protection (if applicable)
[apache-auth]
enabled = false
port = http,https
logpath = /var/log/apache2/*error.log
bantime = 3600
maxretry = 3

[nginx-http-auth]
enabled = false
port = http,https
logpath = /var/log/nginx/error.log
bantime = 3600
maxretry = 3

# Additional protection
[recidive]
enabled = true
logpath = /var/log/fail2ban.log
banaction = iptables-allports
bantime = 604800         # 1 week for repeat offenders
findtime = 86400         # 24 hours
maxretry = 3             # 3 bans in 24 hours = 1 week ban