# Astro Server - Hardened SSH Configuration
# Production-ready SSH security settings

# Authentication Settings
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys
PermitEmptyPasswords no
ChallengeResponseAuthentication no
KbdInteractiveAuthentication no
UsePAM yes

# Connection Limits
MaxAuthTries 3
MaxSessions 2
MaxStartups 10:30:60
LoginGraceTime 30

# Protocol Settings
Protocol 2
Port 22
AddressFamily inet

# Security Features
StrictModes yes
IgnoreRhosts yes
HostbasedAuthentication no
PermitUserEnvironment no

# Forwarding Restrictions
AllowTcpForwarding yes
AllowAgentForwarding no
GatewayPorts no
X11Forwarding no
PermitTunnel no

# Session Management
ClientAliveInterval 300
ClientAliveCountMax 2
TCPKeepAlive no

# Logging
SyslogFacility AUTH
LogLevel VERBOSE

# Compression
Compression no

# Subsystems
Subsystem sftp /usr/lib/openssh/sftp-server

# Banner (optional)
# Banner /etc/ssh/banner.txt